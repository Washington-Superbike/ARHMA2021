<?xml version='1.0' encoding='UTF-8' standalone='no'?>
<section xmlns="http://docbook.org/ns/docbook" version="5.0" xmlns:xlink="http://www.w3.org/1999/xlink" xml:id="__main_8h_source" xml:lang="en-US">
<title>Main.h</title>
Go to the documentation of this file.<programlisting linenumbering="unnumbered"><anchor xml:id="__main_8h_source_1l00001"/>00001 
<anchor xml:id="__main_8h_source_1l00055"/>00055 <emphasis role="preprocessor">#pragma&#32;once</emphasis>
<anchor xml:id="__main_8h_source_1l00056"/>00056 <emphasis role="preprocessor">#include&#32;&quot;<link linkend="__c_a_n_8h">CAN.h</link>&quot;</emphasis>
<anchor xml:id="__main_8h_source_1l00057"/>00057 <emphasis role="preprocessor">#include&#32;&quot;<link linkend="__display_8h">Display.h</link>&quot;</emphasis>
<anchor xml:id="__main_8h_source_1l00058"/>00058 <emphasis role="preprocessor">#include&#32;&quot;<link linkend="__precharge_8h">Precharge.h</link>&quot;</emphasis>
<anchor xml:id="__main_8h_source_1l00059"/>00059 <emphasis role="preprocessor">#include&#32;&quot;<link linkend="__data_logging_8h">DataLogging.h</link>&quot;</emphasis>
<anchor xml:id="__main_8h_source_1l00060"/>00060 <emphasis role="preprocessor">#include&#32;&quot;<link linkend="__free_r_t_o_s___t_e_e_n_s_y4_8h">FreeRTOS_TEENSY4.h</link>&quot;</emphasis>
<anchor xml:id="__main_8h_source_1l00061"/>00061 <emphasis role="preprocessor">#include&#32;&lt;TimeLib.h&gt;</emphasis>
<anchor xml:id="__main_8h_source_1l00062"/>00062 
<anchor xml:id="__main_8h_source_1l00063"/>00063 
<anchor xml:id="__main_8h_source_1l00068"/><link linkend="__main_8h_1a9d09068130671d9ca6bf3c9b6fac6e34">00068</link> <emphasis role="preprocessor">#define&#32;CAN_NODES&#32;0</emphasis>
<anchor xml:id="__main_8h_source_1l00069"/>00069 
<anchor xml:id="__main_8h_source_1l00072"/><link linkend="__main_8h_1a9e9f6a6f679efeb38325e7474a2e4c85">00072</link> <emphasis role="preprocessor">#define&#32;NUM_THERMI&#32;10</emphasis>
<anchor xml:id="__main_8h_source_1l00073"/>00073 
<anchor xml:id="__main_8h_source_1l00077"/><link linkend="__main_8h_1a25cab1c2dd63e90138b14fec27cecc4b">00077</link> <emphasis role="keyword">static</emphasis>&#32;<link linkend="_struct_screen_info">Screen</link>&#32;<link linkend="__main_8h_1a25cab1c2dd63e90138b14fec27cecc4b">screen</link>&#32;=&#32;{<link linkend="__display_8h_1a9d50b8f9fd58d362446e491fe902173fac56c12ae3cd1cef7c03d814f5ef70fab">SPEEDOMETER</link>};
<anchor xml:id="__main_8h_source_1l00078"/>00078 
<anchor xml:id="__main_8h_source_1l00079"/>00079 <emphasis role="comment">//&#32;BMS&#32;and&#32;Battery&#32;values.&#32;Determined&#32;via&#32;CAN&#32;and&#32;other&#32;protocols.</emphasis>
<anchor xml:id="__main_8h_source_1l00080"/>00080 <emphasis role="comment">//&#32;TODO:&#32;PROBABLY&#32;ADD&#32;THE&#32;LV&#32;System&#32;current&#32;here.</emphasis>
<anchor xml:id="__main_8h_source_1l00082"/><link linkend="__main_8h_1a04c234659b28f92e2eab7998b586bb4c">00082</link> <emphasis role="comment"></emphasis><emphasis role="keyword">static</emphasis>&#32;<emphasis role="keywordtype">int</emphasis>&#32;<link linkend="__main_8h_1a04c234659b28f92e2eab7998b586bb4c">bms_status_flag</link>&#32;=&#32;0;
<anchor xml:id="__main_8h_source_1l00084"/><link linkend="__main_8h_1a54619d6c6a00d3268f764c33bd352ebf">00084</link> <emphasis role="keyword">static</emphasis>&#32;<emphasis role="keywordtype">int</emphasis>&#32;<link linkend="__main_8h_1a54619d6c6a00d3268f764c33bd352ebf">bms_c_id</link>&#32;=&#32;0;
<anchor xml:id="__main_8h_source_1l00086"/><link linkend="__main_8h_1a668e87eca74f2126136ee32a6964005e">00086</link> <emphasis role="keyword">static</emphasis>&#32;<emphasis role="keywordtype">int</emphasis>&#32;<link linkend="__main_8h_1a668e87eca74f2126136ee32a6964005e">bms_c_fault</link>&#32;=&#32;0;
<anchor xml:id="__main_8h_source_1l00088"/><link linkend="__main_8h_1ae21e58b785392a0951862c107609d059">00088</link> <emphasis role="keyword">static</emphasis>&#32;<emphasis role="keywordtype">int</emphasis>&#32;<link linkend="__main_8h_1ae21e58b785392a0951862c107609d059">ltc_fault</link>&#32;=&#32;0;
<anchor xml:id="__main_8h_source_1l00090"/><link linkend="__main_8h_1a0de2096b0657dfd13ffeb3d18ae5d65c">00090</link> <emphasis role="keyword">static</emphasis>&#32;<emphasis role="keywordtype">int</emphasis>&#32;<link linkend="__main_8h_1a0de2096b0657dfd13ffeb3d18ae5d65c">ltc_count</link>&#32;=&#32;0;
<anchor xml:id="__main_8h_source_1l00092"/><link linkend="__main_8h_1aad0824db126321851b9f0c49a3115de5">00092</link> <emphasis role="keyword">static</emphasis>&#32;<emphasis role="keywordtype">float</emphasis>&#32;<link linkend="__main_8h_1aad0824db126321851b9f0c49a3115de5">cellVoltagesArr</link>[<link linkend="__c_a_n_8h_1aedb50849ed846717c3096b10fb75d537">BMS_CELLS</link>];&#32;&#32;<emphasis role="comment">//&#32;voltages&#32;starting&#32;with&#32;the&#32;first&#32;LTC</emphasis>
<anchor xml:id="__main_8h_source_1l00094"/><link linkend="__main_8h_1ad2b91d0118e98c42f7d552fd5d3056ed">00094</link> <emphasis role="comment"></emphasis><emphasis role="keyword">static</emphasis>&#32;<emphasis role="keywordtype">float</emphasis>&#32;<link linkend="__main_8h_1ad2b91d0118e98c42f7d552fd5d3056ed">seriesVoltage</link>;
<anchor xml:id="__main_8h_source_1l00096"/><link linkend="__main_8h_1a006c7981abf25c0944f67d017aa5fe1f">00096</link> <emphasis role="keyword">static</emphasis>&#32;<emphasis role="keywordtype">bool</emphasis>&#32;<link linkend="__main_8h_1a006c7981abf25c0944f67d017aa5fe1f">cellsReady</link>;
<anchor xml:id="__main_8h_source_1l00098"/><link linkend="__main_8h_1a283b736b2bddfc8cbec62fe0759a9cd3">00098</link> <emphasis role="keyword">static</emphasis>&#32;<emphasis role="keywordtype">float</emphasis>&#32;<link linkend="__main_8h_1a283b736b2bddfc8cbec62fe0759a9cd3">thTemps</link>[<link linkend="__main_8h_1a9e9f6a6f679efeb38325e7474a2e4c85">NUM_THERMI</link>];
<anchor xml:id="__main_8h_source_1l00100"/><link linkend="__main_8h_1aefa2152d1586505d2d271edc7e9c4187">00100</link> <emphasis role="keyword">static</emphasis>&#32;<emphasis role="keywordtype">int</emphasis>&#32;<link linkend="__main_8h_1aefa2152d1586505d2d271edc7e9c4187">thermistorEnabled</link>;
<anchor xml:id="__main_8h_source_1l00102"/><link linkend="__main_8h_1ad2bc733f382fc4bf0379382e3a15a94e">00102</link> <emphasis role="keyword">static</emphasis>&#32;<emphasis role="keywordtype">int</emphasis>&#32;<link linkend="__main_8h_1ad2bc733f382fc4bf0379382e3a15a94e">thermistorPresent</link>;
<anchor xml:id="__main_8h_source_1l00104"/><link linkend="__main_8h_1a68edb5124f79f990fb79a9e5b7a7f1e8">00104</link> <emphasis role="keyword">static</emphasis>&#32;<emphasis role="keywordtype">float</emphasis>&#32;<link linkend="__main_8h_1a68edb5124f79f990fb79a9e5b7a7f1e8">auxiliaryBatteryVoltage</link>&#32;=&#32;0;
<anchor xml:id="__main_8h_source_1l00105"/>00105 
<anchor xml:id="__main_8h_source_1l00106"/>00106 <emphasis role="comment">//&#32;All&#32;these&#32;variables&#32;are&#32;used&#32;to&#32;read&#32;in&#32;the&#32;data&#32;from&#32;the&#32;gyroscope.</emphasis>
<anchor xml:id="__main_8h_source_1l00108"/><link linkend="__main_8h_1a6cb6d63c8afdc45f4ef149e6d3750a1c">00108</link> <emphasis role="comment"></emphasis><emphasis role="keyword">static</emphasis>&#32;<emphasis role="keywordtype">float</emphasis>&#32;<link linkend="__main_8h_1a6cb6d63c8afdc45f4ef149e6d3750a1c">angle_X</link>&#32;=&#32;0.0;
<anchor xml:id="__main_8h_source_1l00110"/><link linkend="__main_8h_1a89aa0714a95ede6f4c623dbeb38ff019">00110</link> <emphasis role="keyword">static</emphasis>&#32;<emphasis role="keywordtype">float</emphasis>&#32;<link linkend="__main_8h_1a89aa0714a95ede6f4c623dbeb38ff019">angle_Y</link>&#32;=&#32;0.0;
<anchor xml:id="__main_8h_source_1l00112"/><link linkend="__main_8h_1a5ac66e09e5f95b02b3a99a4a2a33f0aa">00112</link> <emphasis role="keyword">static</emphasis>&#32;<emphasis role="keywordtype">float</emphasis>&#32;<link linkend="__main_8h_1a5ac66e09e5f95b02b3a99a4a2a33f0aa">Rate_Roll</link>&#32;=&#32;0.0;
<anchor xml:id="__main_8h_source_1l00114"/><link linkend="__main_8h_1ae4de7890b46aeb807d61f0b71efc9ffe">00114</link> <emphasis role="keyword">static</emphasis>&#32;<emphasis role="keywordtype">float</emphasis>&#32;<link linkend="__main_8h_1ae4de7890b46aeb807d61f0b71efc9ffe">Rate_Pitch</link>&#32;=&#32;0.0;
<anchor xml:id="__main_8h_source_1l00116"/><link linkend="__main_8h_1a537fbd46985b9026ec7d6d0360d1d4d0">00116</link> <emphasis role="keyword">static</emphasis>&#32;<emphasis role="keywordtype">float</emphasis>&#32;<link linkend="__main_8h_1a537fbd46985b9026ec7d6d0360d1d4d0">Rate_Yaw</link>&#32;=&#32;0.0;
<anchor xml:id="__main_8h_source_1l00118"/><link linkend="__main_8h_1a1fde90bfdfb774d5f83e5fea79c17caf">00118</link> <emphasis role="keyword">static</emphasis>&#32;<emphasis role="keywordtype">float</emphasis>&#32;<link linkend="__main_8h_1a1fde90bfdfb774d5f83e5fea79c17caf">Rate_CalibrationRoll</link>&#32;=&#32;0.0;
<anchor xml:id="__main_8h_source_1l00120"/><link linkend="__main_8h_1a474d53e2608e3f1b00990ca9a7ccc64a">00120</link> <emphasis role="keyword">static</emphasis>&#32;<emphasis role="keywordtype">float</emphasis>&#32;<link linkend="__main_8h_1a474d53e2608e3f1b00990ca9a7ccc64a">Rate_CalibrationPitch</link>&#32;=&#32;0.0;
<anchor xml:id="__main_8h_source_1l00122"/><link linkend="__main_8h_1af1c993c5e41ee4d2e881139640989c1a">00122</link> <emphasis role="keyword">static</emphasis>&#32;<emphasis role="keywordtype">float</emphasis>&#32;<link linkend="__main_8h_1af1c993c5e41ee4d2e881139640989c1a">Rate_CalibrationYaw</link>&#32;=&#32;0.0;
<anchor xml:id="__main_8h_source_1l00124"/><link linkend="__main_8h_1a94bbee6853ba61e7fa11539e15174888">00124</link> <emphasis role="keyword">static</emphasis>&#32;<emphasis role="keywordtype">int</emphasis>&#32;<link linkend="__main_8h_1a94bbee6853ba61e7fa11539e15174888">Rate_CalibrationNumber</link>&#32;=&#32;0;
<anchor xml:id="__main_8h_source_1l00125"/>00125 
<anchor xml:id="__main_8h_source_1l00127"/><link linkend="__main_8h_1a93a21521d3b3e91006f1957dabab890b">00127</link> <emphasis role="keyword">static</emphasis>&#32;<emphasis role="keywordtype">float</emphasis>&#32;<link linkend="__main_8h_1a93a21521d3b3e91006f1957dabab890b">Acc_X</link>&#32;=&#32;0.0;
<anchor xml:id="__main_8h_source_1l00129"/><link linkend="__main_8h_1a3b4304cff5611528af473a1dfb86c345">00129</link> <emphasis role="keyword">static</emphasis>&#32;<emphasis role="keywordtype">float</emphasis>&#32;<link linkend="__main_8h_1a3b4304cff5611528af473a1dfb86c345">Acc_Y</link>&#32;=&#32;0.0;
<anchor xml:id="__main_8h_source_1l00131"/><link linkend="__main_8h_1a68e2313572725be66b8d99950942dfb4">00131</link> <emphasis role="keyword">static</emphasis>&#32;<emphasis role="keywordtype">float</emphasis>&#32;<link linkend="__main_8h_1a68e2313572725be66b8d99950942dfb4">Acc_Z</link>&#32;=&#32;0.0;
<anchor xml:id="__main_8h_source_1l00133"/><link linkend="__main_8h_1a6514f0d80926dc8e4aea4c92bd86c9eb">00133</link> <emphasis role="keyword">static</emphasis>&#32;<emphasis role="keywordtype">float</emphasis>&#32;<link linkend="__main_8h_1a6514f0d80926dc8e4aea4c92bd86c9eb">Angle_Roll</link>&#32;=&#32;0.0;
<anchor xml:id="__main_8h_source_1l00135"/><link linkend="__main_8h_1acbed8fcd71fbc60a2452c5e5e9433903">00135</link> <emphasis role="keyword">static</emphasis>&#32;<emphasis role="keywordtype">float</emphasis>&#32;<link linkend="__main_8h_1acbed8fcd71fbc60a2452c5e5e9433903">Angle_Pitch</link>&#32;=&#32;0.0;
<anchor xml:id="__main_8h_source_1l00136"/>00136 
<anchor xml:id="__main_8h_source_1l00137"/>00137 <emphasis role="comment">//&#32;All&#32;these&#32;variables&#32;are&#32;used&#32;to&#32;filter&#32;the&#32;gyroscope&#32;angles&#32;using&#32;the&#32;Kalman&#32;filter.</emphasis>
<anchor xml:id="__main_8h_source_1l00139"/><link linkend="__main_8h_1ac2f400fd7d3933dbf70df179a012817a">00139</link> <emphasis role="comment"></emphasis><emphasis role="keyword">static</emphasis>&#32;<emphasis role="keywordtype">float</emphasis>&#32;<link linkend="__main_8h_1ac2f400fd7d3933dbf70df179a012817a">Kalman_AngleRoll</link>&#32;=&#32;0.0;
<anchor xml:id="__main_8h_source_1l00141"/><link linkend="__main_8h_1a2896dd40967cce4e4f8b65e93cc2fb9d">00141</link> <emphasis role="keyword">static</emphasis>&#32;<emphasis role="keywordtype">float</emphasis>&#32;<link linkend="__main_8h_1a2896dd40967cce4e4f8b65e93cc2fb9d">Kalman_UncertaintyAngleRoll</link>&#32;=&#32;2&#32;*&#32;2;
<anchor xml:id="__main_8h_source_1l00143"/><link linkend="__main_8h_1afb2a04d0a4be86d47607dea17db62631">00143</link> <emphasis role="keyword">static</emphasis>&#32;<emphasis role="keywordtype">float</emphasis>&#32;<link linkend="__main_8h_1afb2a04d0a4be86d47607dea17db62631">Kalman_AnglePitch</link>&#32;=&#32;0;
<anchor xml:id="__main_8h_source_1l00145"/><link linkend="__main_8h_1ae5ea9a8add204eed975816b032f4db3b">00145</link> <emphasis role="keyword">static</emphasis>&#32;<emphasis role="keywordtype">float</emphasis>&#32;<link linkend="__main_8h_1ae5ea9a8add204eed975816b032f4db3b">Kalman_UncertaintyAnglePitch</link>&#32;=&#32;2&#32;*&#32;2;
<anchor xml:id="__main_8h_source_1l00147"/><link linkend="__main_8h_1a077d47652e49b1a9d682fd58ae94ba46">00147</link> <emphasis role="keyword">static</emphasis>&#32;<emphasis role="keywordtype">float</emphasis>&#32;<link linkend="__main_8h_1a077d47652e49b1a9d682fd58ae94ba46">Kalman_1DOutput</link>[]&#32;=&#32;{0,&#32;0};
<anchor xml:id="__main_8h_source_1l00148"/>00148 
<anchor xml:id="__main_8h_source_1l00149"/>00149 <emphasis role="comment">//&#32;All&#32;these&#32;variables&#32;are&#32;can&#32;values&#32;derived&#32;from&#32;the&#32;motor&#32;controller.</emphasis>
<anchor xml:id="__main_8h_source_1l00151"/><link linkend="__main_8h_1ade4e42cdef2d4a9d50b3184100ad8cba">00151</link> <emphasis role="comment"></emphasis><emphasis role="keyword">static</emphasis>&#32;<emphasis role="keywordtype">float</emphasis>&#32;<link linkend="__main_8h_1ade4e42cdef2d4a9d50b3184100ad8cba">RPM</link>&#32;=&#32;0;
<anchor xml:id="__main_8h_source_1l00153"/><link linkend="__main_8h_1a7facdac5aec018a06fc1443c2f90a66d">00153</link> <emphasis role="keyword">static</emphasis>&#32;<emphasis role="keywordtype">float</emphasis>&#32;<link linkend="__main_8h_1a7facdac5aec018a06fc1443c2f90a66d">motorCurrent</link>&#32;=&#32;0;
<anchor xml:id="__main_8h_source_1l00155"/><link linkend="__main_8h_1aca95a5d67296e1cf7fd5d05296cefc5a">00155</link> <emphasis role="keyword">static</emphasis>&#32;<emphasis role="keywordtype">float</emphasis>&#32;<link linkend="__main_8h_1aca95a5d67296e1cf7fd5d05296cefc5a">motorControllerBatteryVoltage</link>&#32;=&#32;0;
<anchor xml:id="__main_8h_source_1l00157"/><link linkend="__main_8h_1adca97acc6b0ff71f782f9c8a484a47b8">00157</link> <emphasis role="keyword">static</emphasis>&#32;<emphasis role="keywordtype">float</emphasis>&#32;<link linkend="__main_8h_1adca97acc6b0ff71f782f9c8a484a47b8">throttle</link>&#32;=&#32;0;
<anchor xml:id="__main_8h_source_1l00159"/><link linkend="__main_8h_1a45af45f80ded31266ad90143957a4e5e">00159</link> <emphasis role="keyword">static</emphasis>&#32;<emphasis role="keywordtype">float</emphasis>&#32;<link linkend="__main_8h_1a45af45f80ded31266ad90143957a4e5e">motorControllerTemp</link>&#32;=&#32;0;
<anchor xml:id="__main_8h_source_1l00161"/><link linkend="__main_8h_1adf4cca4e15700419969edf3ce2ffe6e6">00161</link> <emphasis role="keyword">static</emphasis>&#32;<emphasis role="keywordtype">float</emphasis>&#32;<link linkend="__main_8h_1adf4cca4e15700419969edf3ce2ffe6e6">motorTemp</link>&#32;=&#32;0;
<anchor xml:id="__main_8h_source_1l00163"/><link linkend="__main_8h_1a9e20c92d5e427acd66b85b1451d23a6b">00163</link> <emphasis role="keyword">static</emphasis>&#32;<emphasis role="keywordtype">int</emphasis>&#32;<link linkend="__main_8h_1a9e20c92d5e427acd66b85b1451d23a6b">errorMessage</link>&#32;=&#32;0;
<anchor xml:id="__main_8h_source_1l00165"/><link linkend="__main_8h_1ae40c5f8677bda4442f02f482f3b50d33">00165</link> <emphasis role="keyword">static</emphasis>&#32;<emphasis role="keywordtype">byte</emphasis>&#32;<link linkend="__main_8h_1ae40c5f8677bda4442f02f482f3b50d33">controllerStatus</link>&#32;=&#32;0;
<anchor xml:id="__main_8h_source_1l00166"/>00166 
<anchor xml:id="__main_8h_source_1l00167"/>00167 <emphasis role="comment">//&#32;Charge&#32;controller&#32;variables</emphasis>
<anchor xml:id="__main_8h_source_1l00169"/><link linkend="__main_8h_1a1e5e5db4f4b03ea34fcc2aaf5a334f2a">00169</link> <emphasis role="comment"></emphasis><emphasis role="keyword">static</emphasis>&#32;<emphasis role="keywordtype">byte</emphasis>&#32;<link linkend="__main_8h_1a1e5e5db4f4b03ea34fcc2aaf5a334f2a">evccEnable</link>&#32;=&#32;0;
<anchor xml:id="__main_8h_source_1l00171"/><link linkend="__main_8h_1a10823f3996ecbd5481190d44baa7fd8e">00171</link> <emphasis role="keyword">static</emphasis>&#32;<emphasis role="keywordtype">float</emphasis>&#32;<link linkend="__main_8h_1a10823f3996ecbd5481190d44baa7fd8e">evccVoltage</link>&#32;=&#32;0;
<anchor xml:id="__main_8h_source_1l00173"/><link linkend="__main_8h_1a283f91fe8cbd45a92dda13dd793bbbe0">00173</link> <emphasis role="keyword">static</emphasis>&#32;<emphasis role="keywordtype">float</emphasis>&#32;<link linkend="__main_8h_1a283f91fe8cbd45a92dda13dd793bbbe0">evccCurrent</link>&#32;=&#32;0;
<anchor xml:id="__main_8h_source_1l00174"/>00174 
<anchor xml:id="__main_8h_source_1l00175"/>00175 <emphasis role="comment">//&#32;Charger&#32;variables</emphasis>
<anchor xml:id="__main_8h_source_1l00177"/><link linkend="__main_8h_1a1e4f6826343fcd16576ce3c411fb2287">00177</link> <emphasis role="comment"></emphasis><emphasis role="keyword">static</emphasis>&#32;<emphasis role="keywordtype">byte</emphasis>&#32;<link linkend="__main_8h_1a1e4f6826343fcd16576ce3c411fb2287">chargeFlag</link>&#32;=&#32;0;
<anchor xml:id="__main_8h_source_1l00179"/><link linkend="__main_8h_1a5613c4060f829f65acaac2bc064ae063">00179</link> <emphasis role="keyword">static</emphasis>&#32;<emphasis role="keywordtype">byte</emphasis>&#32;<link linkend="__main_8h_1a5613c4060f829f65acaac2bc064ae063">chargerStatusFlag</link>&#32;=&#32;0;
<anchor xml:id="__main_8h_source_1l00181"/><link linkend="__main_8h_1ab11fffe9a473928798422de66fcde502">00181</link> <emphasis role="keyword">static</emphasis>&#32;<emphasis role="keywordtype">float</emphasis>&#32;<link linkend="__main_8h_1ab11fffe9a473928798422de66fcde502">chargerVoltage</link>&#32;=&#32;0;
<anchor xml:id="__main_8h_source_1l00183"/><link linkend="__main_8h_1a8b27b4284d9d4039618e5da068c2bc7f">00183</link> <emphasis role="keyword">static</emphasis>&#32;<emphasis role="keywordtype">float</emphasis>&#32;<link linkend="__main_8h_1a8b27b4284d9d4039618e5da068c2bc7f">chargerCurrent</link>&#32;=&#32;0;
<anchor xml:id="__main_8h_source_1l00185"/><link linkend="__main_8h_1a85ede348554a838fb67a3ceb3313be5b">00185</link> <emphasis role="keyword">static</emphasis>&#32;int8_t&#32;<link linkend="__main_8h_1a85ede348554a838fb67a3ceb3313be5b">chargerTemp</link>&#32;=&#32;0;
<anchor xml:id="__main_8h_source_1l00186"/>00186 
<anchor xml:id="__main_8h_source_1l00188"/><link linkend="__main_8h_1a962a20f8dc1ba6934fdc04e44bde53a8">00188</link> <emphasis role="keyword">static</emphasis>&#32;<link linkend="_struct_measurement_screen_data_struct">MeasurementScreenData</link>&#32;<link linkend="__main_8h_1a962a20f8dc1ba6934fdc04e44bde53a8">measurementData</link>&#32;=&#32;{};
<anchor xml:id="__main_8h_source_1l00190"/><link linkend="__main_8h_1a9eeb128a9907154869e9ffa78e065039">00190</link> <emphasis role="keyword">static</emphasis>&#32;<link linkend="_struct_motor_stats">MotorStats</link>&#32;<link linkend="__main_8h_1a9eeb128a9907154869e9ffa78e065039">motorStats</link>&#32;=&#32;{};
<anchor xml:id="__main_8h_source_1l00192"/><link linkend="__main_8h_1abb61c6dc61d12b31aad7bdadd495b70a">00192</link> <emphasis role="keyword">static</emphasis>&#32;<link linkend="_struct_motor_temps">MotorTemps</link>&#32;<link linkend="__main_8h_1abb61c6dc61d12b31aad7bdadd495b70a">motorTemps</link>&#32;=&#32;{};
<anchor xml:id="__main_8h_source_1l00194"/><link linkend="__main_8h_1afca6798677cebeeb7599ea00e1e243dd">00194</link> <emphasis role="keyword">static</emphasis>&#32;<link linkend="_struct_cell_voltages">CellVoltages</link>&#32;<link linkend="__main_8h_1afca6798677cebeeb7599ea00e1e243dd">cellVoltages</link>&#32;=&#32;{};
<anchor xml:id="__main_8h_source_1l00196"/><link linkend="__main_8h_1ae0522609134711f92c96ffa8ed05e582">00196</link> <emphasis role="keyword">static</emphasis>&#32;<link linkend="_struct_b_m_s_status">BMSStatus</link>&#32;<link linkend="__main_8h_1ae0522609134711f92c96ffa8ed05e582">bmsStatus</link>&#32;=&#32;{};
<anchor xml:id="__main_8h_source_1l00198"/><link linkend="__main_8h_1a18571448b101f12a60457d717dc4f953">00198</link> <emphasis role="keyword">static</emphasis>&#32;<link linkend="_struct_thermistor_temps">ThermistorTemps</link>&#32;<link linkend="__main_8h_1a18571448b101f12a60457d717dc4f953">thermistorTemps</link>&#32;=&#32;{};
<anchor xml:id="__main_8h_source_1l00200"/><link linkend="__main_8h_1aa249f1d073086c27682168bbd7dc77ee">00200</link> <emphasis role="keyword">static</emphasis>&#32;<link linkend="_struct_charger_stats">ChargerStats</link>&#32;<link linkend="__main_8h_1aa249f1d073086c27682168bbd7dc77ee">chargerStats</link>&#32;=&#32;{};
<anchor xml:id="__main_8h_source_1l00202"/><link linkend="__main_8h_1a566a5d391bca1611a2bfd1d97a1aa24c">00202</link> <emphasis role="keyword">static</emphasis>&#32;<link linkend="_struct_charge_controller_stats">ChargeControllerStats</link>&#32;<link linkend="__main_8h_1a566a5d391bca1611a2bfd1d97a1aa24c">chargeControllerStats</link>&#32;=&#32;{};
<anchor xml:id="__main_8h_source_1l00203"/>00203 
<anchor xml:id="__main_8h_source_1l00204"/>00204 <emphasis role="comment">//&#32;These&#32;variables&#32;store&#32;all&#32;the&#32;task&#32;data&#32;for&#32;all&#32;4&#32;tasks&#32;(except&#32;IDLE)</emphasis>
<anchor xml:id="__main_8h_source_1l00206"/><link linkend="__main_8h_1ab1d006bdd632ad57598689186c8ce63a">00206</link> <emphasis role="comment"></emphasis><emphasis role="keyword">static</emphasis>&#32;<link linkend="_struct_c_a_n_task_data">CANTaskData</link>&#32;<link linkend="__main_8h_1ab1d006bdd632ad57598689186c8ce63a">canTaskData</link>;
<anchor xml:id="__main_8h_source_1l00208"/><link linkend="__main_8h_1aebb1e162e2ac30616875763e56823870">00208</link> <emphasis role="keyword">static</emphasis>&#32;<link linkend="_structdisplay_task_wrapper">displayPointer</link>&#32;<link linkend="__main_8h_1aebb1e162e2ac30616875763e56823870">displayTaskWrap</link>&#32;=&#32;{};
<anchor xml:id="__main_8h_source_1l00210"/><link linkend="__main_8h_1af74b66e7d389be76470292071c65f556">00210</link> <emphasis role="keyword">static</emphasis>&#32;<link linkend="_struct_data_logging_task_data">DataLoggingTaskData</link>&#32;<link linkend="__main_8h_1af74b66e7d389be76470292071c65f556">dataLoggingTaskData</link>;
<anchor xml:id="__main_8h_source_1l00212"/><link linkend="__main_8h_1a695dccac97a0f45cf570237e981b2b5d">00212</link> <emphasis role="keyword">static</emphasis>&#32;<link linkend="_struct_pre_charge_task_data">PreChargeTaskData</link>&#32;<link linkend="__main_8h_1a695dccac97a0f45cf570237e981b2b5d">preChargeData</link>&#32;=&#32;{};
<anchor xml:id="__main_8h_source_1l00213"/>00213 
<anchor xml:id="__main_8h_source_1l00214"/>00214 <emphasis role="comment">//&#32;Log&#32;variables&#32;used&#32;for&#32;dataLogging&#32;task.&#32;Change&#32;things&#32;here&#32;if&#32;you&#32;want&#32;to</emphasis>
<anchor xml:id="__main_8h_source_1l00215"/>00215 <emphasis role="comment">//&#32;add&#32;more&#32;variables&#32;to&#32;logging.</emphasis>
<anchor xml:id="__main_8h_source_1l00217"/><link linkend="__main_8h_1a74a7fab0bce9e95dfced1f40d1764e9a">00217</link> <emphasis role="comment"></emphasis><emphasis role="keyword">static</emphasis>&#32;<link linkend="_struct_c_s_v_writer">CSVWriter</link>&#32;<link linkend="__main_8h_1a74a7fab0bce9e95dfced1f40d1764e9a">motorTemperatureLog</link>&#32;=&#32;{};
<anchor xml:id="__main_8h_source_1l00219"/><link linkend="__main_8h_1ae230e041b8d09151f97b07151fdaf38c">00219</link> <emphasis role="keyword">static</emphasis>&#32;<link linkend="_struct_c_s_v_writer">CSVWriter</link>&#32;<link linkend="__main_8h_1ae230e041b8d09151f97b07151fdaf38c">motorControllerTemperatureLog</link>&#32;=&#32;{};
<anchor xml:id="__main_8h_source_1l00221"/><link linkend="__main_8h_1a4ca34bc3c27d808ebe3480bfed4b997a">00221</link> <emphasis role="keyword">static</emphasis>&#32;<link linkend="_struct_c_s_v_writer">CSVWriter</link>&#32;<link linkend="__main_8h_1a4ca34bc3c27d808ebe3480bfed4b997a">motorControllerVoltageLog</link>&#32;=&#32;{};
<anchor xml:id="__main_8h_source_1l00223"/><link linkend="__main_8h_1a3ed95fd1ffa6f914d3bb19bbb59d2cd0">00223</link> <emphasis role="keyword">static</emphasis>&#32;<link linkend="_struct_c_s_v_writer">CSVWriter</link>&#32;<link linkend="__main_8h_1a3ed95fd1ffa6f914d3bb19bbb59d2cd0">motorCurrentLog</link>&#32;=&#32;{};
<anchor xml:id="__main_8h_source_1l00225"/><link linkend="__main_8h_1a60f914a71f12f33ed914208fbf5be838">00225</link> <emphasis role="keyword">static</emphasis>&#32;<link linkend="_struct_c_s_v_writer">CSVWriter</link>&#32;<link linkend="__main_8h_1a60f914a71f12f33ed914208fbf5be838">rpmLog</link>&#32;=&#32;{};
<anchor xml:id="__main_8h_source_1l00227"/><link linkend="__main_8h_1a8941dbd7f821806a7a6f4eb705b1472b">00227</link> <emphasis role="keyword">static</emphasis>&#32;<link linkend="_struct_c_s_v_writer">CSVWriter</link>&#32;<link linkend="__main_8h_1a8941dbd7f821806a7a6f4eb705b1472b">thermistorLog</link>&#32;=&#32;{};
<anchor xml:id="__main_8h_source_1l00229"/><link linkend="__main_8h_1ade498aeeb82732f18af609faa0b323cb">00229</link> <emphasis role="keyword">static</emphasis>&#32;<link linkend="_struct_c_s_v_writer">CSVWriter</link>&#32;<link linkend="__main_8h_1ade498aeeb82732f18af609faa0b323cb">bmsVoltageLog</link>&#32;=&#32;{};
<anchor xml:id="__main_8h_source_1l00231"/><link linkend="__main_8h_1a9462b5ab9931c29422982609bceb3fad">00231</link> <emphasis role="keyword">static</emphasis>&#32;<link linkend="_struct_c_s_v_writer">CSVWriter</link>&#32;*<link linkend="__main_8h_1a9462b5ab9931c29422982609bceb3fad">logs</link>[]&#32;=&#32;{&amp;<link linkend="__main_8h_1a74a7fab0bce9e95dfced1f40d1764e9a">motorTemperatureLog</link>,&#32;&amp;<link linkend="__main_8h_1ae230e041b8d09151f97b07151fdaf38c">motorControllerTemperatureLog</link>,&#32;&amp;<link linkend="__main_8h_1a4ca34bc3c27d808ebe3480bfed4b997a">motorControllerVoltageLog</link>,&#32;&amp;<link linkend="__main_8h_1a3ed95fd1ffa6f914d3bb19bbb59d2cd0">motorCurrentLog</link>,&#32;&amp;<link linkend="__main_8h_1a60f914a71f12f33ed914208fbf5be838">rpmLog</link>,&#32;&amp;<link linkend="__main_8h_1a8941dbd7f821806a7a6f4eb705b1472b">thermistorLog</link>,&#32;&amp;<link linkend="__main_8h_1ade498aeeb82732f18af609faa0b323cb">bmsVoltageLog</link>};
<anchor xml:id="__main_8h_source_1l00232"/>00232 
<anchor xml:id="__main_8h_source_1l00234"/><link linkend="__main_8h_1a61d9ef65d75b66821896182b133b31de">00234</link> <emphasis role="keywordtype">unsigned</emphasis>&#32;<emphasis role="keywordtype">long</emphasis>&#32;<link linkend="__main_8h_1a61d9ef65d75b66821896182b133b31de">timer</link>&#32;=&#32;millis();
<anchor xml:id="__main_8h_source_1l00235"/><link linkend="__main_8h_1a40646f0d9308996b7d391cb8e0d95905">00235</link> <emphasis role="keywordtype">int</emphasis>&#32;<link linkend="__main_8h_1a40646f0d9308996b7d391cb8e0d95905">cycleCount</link>&#32;=&#32;0;
<anchor xml:id="__main_8h_source_1l00236"/>00236 
<anchor xml:id="__main_8h_source_1l00237"/><link linkend="__main_8h_1ad817dda0a86c980182765da5a3cafec8">00237</link> <emphasis role="keywordtype">int</emphasis>&#32;<link linkend="__main_8h_1ad817dda0a86c980182765da5a3cafec8">lowerUpperCells</link>&#32;=&#32;-1;
<anchor xml:id="__main_8h_source_1l00238"/><link linkend="__main_8h_1a548fbf99c23fe3ef17f2e1a7b0992070">00238</link> <emphasis role="keywordtype">unsigned</emphasis>&#32;<emphasis role="keywordtype">long</emphasis>&#32;<link linkend="__main_8h_1a548fbf99c23fe3ef17f2e1a7b0992070">ms</link>&#32;=&#32;millis();
<anchor xml:id="__main_8h_source_1l00239"/><link linkend="__main_8h_1acdca7f14bb24f1cb2aa9d0be982560b2">00239</link> <emphasis role="keywordtype">byte</emphasis>&#32;<link linkend="__main_8h_1acdca7f14bb24f1cb2aa9d0be982560b2">sdStarted</link>&#32;=&#32;0;
<anchor xml:id="__main_8h_source_1l00240"/>00240 
<anchor xml:id="__main_8h_source_1l00241"/><link linkend="__main_8h_1a76c0525d646735793add25b18043e600">00241</link> <link linkend="_struct_queue_definition">SemaphoreHandle_t</link>&#32;<link linkend="__main_8h_1a76c0525d646735793add25b18043e600">spi_mutex</link>;
<anchor xml:id="__main_8h_source_1l00242"/>00242 
<anchor xml:id="__main_8h_source_1l00282"/>00282 <emphasis role="keywordtype">void</emphasis>&#32;<link linkend="__main_8h_1a4fc01d736fe50cf5b977f755b675f11d">setup</link>();
<anchor xml:id="__main_8h_source_1l00289"/>00289 <emphasis role="keywordtype">void</emphasis>&#32;<link linkend="__main_8h_1a31d554847ae8fdeaba2460e0395cb75f">setupPins</link>();
<anchor xml:id="__main_8h_source_1l00299"/>00299 <emphasis role="keywordtype">void</emphasis>&#32;<link linkend="__main_8h_1a128d10ba9e06eb69d1dfc91ffef935ba">initializeDisplayStructs</link>();
<anchor xml:id="__main_8h_source_1l00310"/>00310 <emphasis role="keywordtype">void</emphasis>&#32;<link linkend="__main_8h_1a797cf3c70ce7ae02bba9bfd3f6d886de">initializeLogStructs</link>();
<anchor xml:id="__main_8h_source_1l00323"/>00323 <emphasis role="keywordtype">void</emphasis>&#32;<link linkend="__main_8h_1ab91267714bdf99d7b3d177f95f484157">initializeCANStructs</link>();
<anchor xml:id="__main_8h_source_1l00333"/>00333 <emphasis role="keywordtype">void</emphasis>&#32;<link linkend="__main_8h_1a32469c898d757b2b30c00d0546f91802">initializePreChargeStruct</link>();
<anchor xml:id="__main_8h_source_1l00348"/>00348 <emphasis role="keywordtype">bool</emphasis>&#32;<link linkend="__main_8h_1aafd615bc53c2f27720d792a6a2968209">get_SPI_control</link>(<emphasis role="keywordtype">unsigned</emphasis>&#32;<emphasis role="keywordtype">int</emphasis>&#32;<link linkend="__main_8h_1a548fbf99c23fe3ef17f2e1a7b0992070">ms</link>);
<anchor xml:id="__main_8h_source_1l00363"/>00363 <emphasis role="keywordtype">void</emphasis>&#32;<link linkend="__main_8h_1a966fda2bc617e020cb78f814bb5514c1">release_SPI_control</link>(<emphasis role="keywordtype">void</emphasis>);
<anchor xml:id="__main_8h_source_1l00368"/>00368 time_t&#32;<link linkend="__main_8h_1a3e0781915a9e0f2045e892efe59f9fdc">getTeensy3Time</link>();
<anchor xml:id="__main_8h_source_1l00374"/>00374 <emphasis role="keywordtype">void</emphasis>&#32;<link linkend="__main_8h_1a0d7297755c0775a9b0e4f7eeeafd7c7e">idleTask</link>(<emphasis role="keywordtype">void</emphasis>&#32;*taskData);
<anchor xml:id="__main_8h_source_1l00380"/>00380 <emphasis role="keywordtype">void</emphasis>&#32;<link linkend="__main_8h_1afe461d27b9c48d5921c00d521181f12f">loop</link>();
</programlisting></section>
