<?xml version='1.0' encoding='UTF-8' standalone='no'?>
<section xmlns="http://docbook.org/ns/docbook" version="5.0" xmlns:xlink="http://www.w3.org/1999/xlink" xml:id="__free_r_t_o_s___t_e_e_n_s_y4_8c_source" xml:lang="en-US">
<title>FreeRTOS_TEENSY4.c</title>
<indexterm><primary>FreeRTOS/FreeRTOS_TEENSY4.c</primary></indexterm>
Go to the documentation of this file.<programlisting linenumbering="unnumbered"><anchor xml:id="__free_r_t_o_s___t_e_e_n_s_y4_8c_source_1l00001"/>00001 
<anchor xml:id="__free_r_t_o_s___t_e_e_n_s_y4_8c_source_1l00005"/>00005 <emphasis role="preprocessor">#include&#32;&quot;<link linkend="__free_r_t_o_s___t_e_e_n_s_y4_8h">FreeRTOS_TEENSY4.h</link>&quot;</emphasis>
<anchor xml:id="__free_r_t_o_s___t_e_e_n_s_y4_8c_source_1l00006"/>00006 <emphasis role="preprocessor">#include&#32;&lt;Arduino.h&gt;</emphasis>
<anchor xml:id="__free_r_t_o_s___t_e_e_n_s_y4_8c_source_1l00007"/>00007 <emphasis role="comment">//------------------------------------------------------------------------------</emphasis>
<anchor xml:id="__free_r_t_o_s___t_e_e_n_s_y4_8c_source_1l00009"/><link linkend="__free_r_t_o_s___t_e_e_n_s_y4_8c_1a232ceee9e10a97b8ec8f14503861e699">00009</link> <emphasis role="comment"></emphasis><emphasis role="preprocessor">#define&#32;CAL_FACTOR&#32;(F_CPU/7000)</emphasis>
<anchor xml:id="__free_r_t_o_s___t_e_e_n_s_y4_8c_source_1l00013"/><link linkend="__free_r_t_o_s___t_e_e_n_s_y4_8c_1a4d5e82901421218561290929a1b12548">00013</link> <emphasis role="keyword">static</emphasis>&#32;<emphasis role="keywordtype">void</emphasis>&#32;<link linkend="__free_r_t_o_s___t_e_e_n_s_y4_8c_1a4d5e82901421218561290929a1b12548">delayMS</link>(uint32_t&#32;millis)&#32;{
<anchor xml:id="__free_r_t_o_s___t_e_e_n_s_y4_8c_source_1l00014"/>00014 &#32;&#32;uint32_t&#32;iterations&#32;=&#32;millis&#32;*&#32;<link linkend="__free_r_t_o_s___t_e_e_n_s_y4_8c_1a232ceee9e10a97b8ec8f14503861e699">CAL_FACTOR</link>;
<anchor xml:id="__free_r_t_o_s___t_e_e_n_s_y4_8c_source_1l00015"/>00015 &#32;&#32;uint32_t&#32;i;
<anchor xml:id="__free_r_t_o_s___t_e_e_n_s_y4_8c_source_1l00016"/>00016 &#32;&#32;<emphasis role="keywordflow">for</emphasis>(i&#32;=&#32;0;&#32;i&#32;&lt;&#32;iterations;&#32;++i)&#32;{
<anchor xml:id="__free_r_t_o_s___t_e_e_n_s_y4_8c_source_1l00017"/>00017 &#32;&#32;&#32;&#32;<emphasis role="keyword">asm</emphasis>&#32;<emphasis role="keyword">volatile</emphasis>(<emphasis role="stringliteral">&quot;nop\n\t&quot;</emphasis>);
<anchor xml:id="__free_r_t_o_s___t_e_e_n_s_y4_8c_source_1l00018"/>00018 &#32;&#32;}
<anchor xml:id="__free_r_t_o_s___t_e_e_n_s_y4_8c_source_1l00019"/>00019 }
<anchor xml:id="__free_r_t_o_s___t_e_e_n_s_y4_8c_source_1l00020"/>00020 <emphasis role="comment">//------------------------------------------------------------------------------</emphasis>
<anchor xml:id="__free_r_t_o_s___t_e_e_n_s_y4_8c_source_1l00025"/><link linkend="__free_r_t_o_s___t_e_e_n_s_y4_8c_1a5da8b1b72bfdb1d8a8f7b8581e4160c2">00025</link> <emphasis role="comment"></emphasis><emphasis role="keyword">static</emphasis>&#32;<emphasis role="keywordtype">void</emphasis>&#32;<link linkend="__free_r_t_o_s___t_e_e_n_s_y4_8c_1a5da8b1b72bfdb1d8a8f7b8581e4160c2">errorBlink</link>(<emphasis role="keywordtype">int</emphasis>&#32;n)&#32;{
<anchor xml:id="__free_r_t_o_s___t_e_e_n_s_y4_8c_source_1l00026"/>00026 &#32;&#32;&#32;&#32;noInterrupts();
<anchor xml:id="__free_r_t_o_s___t_e_e_n_s_y4_8c_source_1l00027"/>00027 &#32;&#32;pinMode(13,&#32;OUTPUT);
<anchor xml:id="__free_r_t_o_s___t_e_e_n_s_y4_8c_source_1l00028"/>00028 &#32;&#32;<emphasis role="keywordflow">for</emphasis>&#32;(;;)&#32;{
<anchor xml:id="__free_r_t_o_s___t_e_e_n_s_y4_8c_source_1l00029"/>00029 &#32;&#32;&#32;&#32;<emphasis role="keywordtype">int</emphasis>&#32;i;
<anchor xml:id="__free_r_t_o_s___t_e_e_n_s_y4_8c_source_1l00030"/>00030 &#32;&#32;&#32;&#32;<emphasis role="keywordflow">for</emphasis>&#32;(i&#32;=&#32;0;&#32;i&#32;&lt;&#32;n;&#32;i++)&#32;{
<anchor xml:id="__free_r_t_o_s___t_e_e_n_s_y4_8c_source_1l00031"/>00031 &#32;&#32;&#32;&#32;&#32;&#32;digitalWrite(13,&#32;1);
<anchor xml:id="__free_r_t_o_s___t_e_e_n_s_y4_8c_source_1l00032"/>00032 &#32;&#32;&#32;&#32;&#32;&#32;<link linkend="__free_r_t_o_s___t_e_e_n_s_y4_8c_1a4d5e82901421218561290929a1b12548">delayMS</link>(300);
<anchor xml:id="__free_r_t_o_s___t_e_e_n_s_y4_8c_source_1l00033"/>00033 &#32;&#32;&#32;&#32;&#32;&#32;digitalWrite(13,&#32;0);
<anchor xml:id="__free_r_t_o_s___t_e_e_n_s_y4_8c_source_1l00034"/>00034 &#32;&#32;&#32;&#32;&#32;&#32;<link linkend="__free_r_t_o_s___t_e_e_n_s_y4_8c_1a4d5e82901421218561290929a1b12548">delayMS</link>(300);
<anchor xml:id="__free_r_t_o_s___t_e_e_n_s_y4_8c_source_1l00035"/>00035 &#32;&#32;&#32;&#32;}
<anchor xml:id="__free_r_t_o_s___t_e_e_n_s_y4_8c_source_1l00036"/>00036 &#32;&#32;&#32;&#32;<link linkend="__free_r_t_o_s___t_e_e_n_s_y4_8c_1a4d5e82901421218561290929a1b12548">delayMS</link>(2000);
<anchor xml:id="__free_r_t_o_s___t_e_e_n_s_y4_8c_source_1l00037"/>00037 &#32;&#32;}
<anchor xml:id="__free_r_t_o_s___t_e_e_n_s_y4_8c_source_1l00038"/>00038 }
<anchor xml:id="__free_r_t_o_s___t_e_e_n_s_y4_8c_source_1l00039"/>00039 <emphasis role="comment">//------------------------------------------------------------------------------</emphasis>
<anchor xml:id="__free_r_t_o_s___t_e_e_n_s_y4_8c_source_1l00043"/><link linkend="__free_r_t_o_s___t_e_e_n_s_y4_8c_1aa8cad1e2decb59c70b8247133b61157c">00043</link> <emphasis role="comment"></emphasis><emphasis role="keywordtype">void</emphasis>&#32;<link linkend="__free_r_t_o_s___t_e_e_n_s_y4_8c_1aa8cad1e2decb59c70b8247133b61157c">assertBlink</link>()&#32;{
<anchor xml:id="__free_r_t_o_s___t_e_e_n_s_y4_8c_source_1l00044"/>00044 &#32;&#32;<link linkend="__free_r_t_o_s___t_e_e_n_s_y4_8c_1a5da8b1b72bfdb1d8a8f7b8581e4160c2">errorBlink</link>(1);
<anchor xml:id="__free_r_t_o_s___t_e_e_n_s_y4_8c_source_1l00045"/>00045 }
<anchor xml:id="__free_r_t_o_s___t_e_e_n_s_y4_8c_source_1l00046"/>00046 <emphasis role="comment">//------------------------------------------------------------------------------</emphasis>
<anchor xml:id="__free_r_t_o_s___t_e_e_n_s_y4_8c_source_1l00060"/><link linkend="__free_r_t_o_s___t_e_e_n_s_y4_8c_1a73f6aa45470ada02a5d6f3a522d8f13c">00060</link> <emphasis role="comment"></emphasis><emphasis role="keywordtype">void</emphasis>&#32;<link linkend="__free_r_t_o_s___t_e_e_n_s_y4_8c_1a73f6aa45470ada02a5d6f3a522d8f13c">vApplicationMallocFailedHook</link>()&#32;{
<anchor xml:id="__free_r_t_o_s___t_e_e_n_s_y4_8c_source_1l00061"/>00061 &#32;&#32;<link linkend="__free_r_t_o_s___t_e_e_n_s_y4_8c_1a5da8b1b72bfdb1d8a8f7b8581e4160c2">errorBlink</link>(2);
<anchor xml:id="__free_r_t_o_s___t_e_e_n_s_y4_8c_source_1l00062"/>00062 }
<anchor xml:id="__free_r_t_o_s___t_e_e_n_s_y4_8c_source_1l00063"/>00063 <emphasis role="comment">//------------------------------------------------------------------------------</emphasis>
<anchor xml:id="__free_r_t_o_s___t_e_e_n_s_y4_8c_source_1l00064"/>00064 
<anchor xml:id="__free_r_t_o_s___t_e_e_n_s_y4_8c_source_1l00074"/><link linkend="__free_r_t_o_s___t_e_e_n_s_y4_8c_1a201468129b483039afc5a619e2d31097">00074</link> <emphasis role="keywordtype">void</emphasis>&#32;&#32;<link linkend="__free_r_t_o_s___t_e_e_n_s_y4_8c_1a201468129b483039afc5a619e2d31097">__attribute__</link>((weak))&#32;vApplicationIdleHook(&#32;<emphasis role="keywordtype">void</emphasis>&#32;)&#32;{
<anchor xml:id="__free_r_t_o_s___t_e_e_n_s_y4_8c_source_1l00075"/>00075 &#32;&#32;<emphasis role="keywordtype">void</emphasis>&#32;<link linkend="__main_8h_1afe461d27b9c48d5921c00d521181f12f">loop</link>();
<anchor xml:id="__free_r_t_o_s___t_e_e_n_s_y4_8c_source_1l00076"/>00076 &#32;&#32;<link linkend="__main_8h_1afe461d27b9c48d5921c00d521181f12f">loop</link>();
<anchor xml:id="__free_r_t_o_s___t_e_e_n_s_y4_8c_source_1l00077"/>00077 }
<anchor xml:id="__free_r_t_o_s___t_e_e_n_s_y4_8c_source_1l00078"/>00078 <emphasis role="comment">/*-----------------------------------------------------------*/</emphasis>
<anchor xml:id="__free_r_t_o_s___t_e_e_n_s_y4_8c_source_1l00086"/><link linkend="__free_r_t_o_s___t_e_e_n_s_y4_8c_1a306672a74bdd13ce210c05fca3385c59">00086</link> <emphasis role="keywordtype">void</emphasis>&#32;<link linkend="__free_r_t_o_s___t_e_e_n_s_y4_8c_1a306672a74bdd13ce210c05fca3385c59">vApplicationStackOverflowHook</link>(<link linkend="_structtsk_task_control_block">TaskHandle_t</link>&#32;pxTask,&#32;<emphasis role="keywordtype">char</emphasis>&#32;*pcTaskName)&#32;{
<anchor xml:id="__free_r_t_o_s___t_e_e_n_s_y4_8c_source_1l00087"/>00087 &#32;&#32;&#32;&#32;(void)&#32;pcTaskName;
<anchor xml:id="__free_r_t_o_s___t_e_e_n_s_y4_8c_source_1l00088"/>00088 &#32;&#32;&#32;&#32;(void)&#32;pxTask;
<anchor xml:id="__free_r_t_o_s___t_e_e_n_s_y4_8c_source_1l00089"/>00089 &#32;&#32;&#32;&#32;<link linkend="__free_r_t_o_s___t_e_e_n_s_y4_8c_1a5da8b1b72bfdb1d8a8f7b8581e4160c2">errorBlink</link>(3);
<anchor xml:id="__free_r_t_o_s___t_e_e_n_s_y4_8c_source_1l00090"/>00090 }
<anchor xml:id="__free_r_t_o_s___t_e_e_n_s_y4_8c_source_1l00091"/>00091 <emphasis role="comment">//------------------------------------------------------------------------------</emphasis>
<anchor xml:id="__free_r_t_o_s___t_e_e_n_s_y4_8c_source_1l00092"/>00092 <emphasis role="comment">//&#32;catch&#32;Teensy&#32;3&#32;and&#32;Due&#32;exceptions</emphasis>
<anchor xml:id="__free_r_t_o_s___t_e_e_n_s_y4_8c_source_1l00094"/><link linkend="__free_r_t_o_s___t_e_e_n_s_y4_8c_1a5b27d72b205084efd5c6b2f18838724b">00094</link> <emphasis role="comment"></emphasis><emphasis role="keywordtype">void</emphasis>&#32;<link linkend="__free_r_t_o_s___t_e_e_n_s_y4_8c_1a5b27d72b205084efd5c6b2f18838724b">hard_fault_isr</link>()&#32;&#32;&#32;{<link linkend="__free_r_t_o_s___t_e_e_n_s_y4_8c_1a5da8b1b72bfdb1d8a8f7b8581e4160c2">errorBlink</link>(4);}
<anchor xml:id="__free_r_t_o_s___t_e_e_n_s_y4_8c_source_1l00096"/><link linkend="__free_r_t_o_s___t_e_e_n_s_y4_8c_1a2af56a8bf3197b2f06cac4c0b84ffc3e">00096</link> <emphasis role="keywordtype">void</emphasis>&#32;<link linkend="__free_r_t_o_s___t_e_e_n_s_y4_8c_1a2af56a8bf3197b2f06cac4c0b84ffc3e">HardFault_Handler</link>()&#32;&#32;&#32;&#32;{<link linkend="__free_r_t_o_s___t_e_e_n_s_y4_8c_1a5da8b1b72bfdb1d8a8f7b8581e4160c2">errorBlink</link>(4);}
<anchor xml:id="__free_r_t_o_s___t_e_e_n_s_y4_8c_source_1l00097"/>00097 
<anchor xml:id="__free_r_t_o_s___t_e_e_n_s_y4_8c_source_1l00099"/><link linkend="__free_r_t_o_s___t_e_e_n_s_y4_8c_1ae2d60774bb61a4f46e670ea245570f95">00099</link> <emphasis role="keywordtype">void</emphasis>&#32;<link linkend="__free_r_t_o_s___t_e_e_n_s_y4_8c_1ae2d60774bb61a4f46e670ea245570f95">bus_fault_isr</link>()&#32;{<link linkend="__free_r_t_o_s___t_e_e_n_s_y4_8c_1a5da8b1b72bfdb1d8a8f7b8581e4160c2">errorBlink</link>(5);}
<anchor xml:id="__free_r_t_o_s___t_e_e_n_s_y4_8c_source_1l00101"/><link linkend="__free_r_t_o_s___t_e_e_n_s_y4_8c_1a12baaa0dec32c007fbc333df880025c9">00101</link> <emphasis role="keywordtype">void</emphasis>&#32;<link linkend="__free_r_t_o_s___t_e_e_n_s_y4_8c_1a12baaa0dec32c007fbc333df880025c9">BusFault_Handler</link>()&#32;{<link linkend="__free_r_t_o_s___t_e_e_n_s_y4_8c_1a5da8b1b72bfdb1d8a8f7b8581e4160c2">errorBlink</link>(5);}
<anchor xml:id="__free_r_t_o_s___t_e_e_n_s_y4_8c_source_1l00102"/>00102 
<anchor xml:id="__free_r_t_o_s___t_e_e_n_s_y4_8c_source_1l00104"/><link linkend="__free_r_t_o_s___t_e_e_n_s_y4_8c_1af556591e06c5d6cad7fd16bdc3f2da1e">00104</link> <emphasis role="keywordtype">void</emphasis>&#32;<link linkend="__free_r_t_o_s___t_e_e_n_s_y4_8c_1af556591e06c5d6cad7fd16bdc3f2da1e">usage_fault_isr</link>()&#32;{<link linkend="__free_r_t_o_s___t_e_e_n_s_y4_8c_1a5da8b1b72bfdb1d8a8f7b8581e4160c2">errorBlink</link>(6);}
<anchor xml:id="__free_r_t_o_s___t_e_e_n_s_y4_8c_source_1l00106"/><link linkend="__free_r_t_o_s___t_e_e_n_s_y4_8c_1ac4b80575ac8f7fdb0c96faa95810d0e4">00106</link> <emphasis role="keywordtype">void</emphasis>&#32;<link linkend="__free_r_t_o_s___t_e_e_n_s_y4_8c_1ac4b80575ac8f7fdb0c96faa95810d0e4">UsageFault_Handler</link>()&#32;{<link linkend="__free_r_t_o_s___t_e_e_n_s_y4_8c_1a5da8b1b72bfdb1d8a8f7b8581e4160c2">errorBlink</link>(6);}
<anchor xml:id="__free_r_t_o_s___t_e_e_n_s_y4_8c_source_1l00107"/>00107 <emphasis role="comment">/*-----------------------------------------------------------*/</emphasis>
<anchor xml:id="__free_r_t_o_s___t_e_e_n_s_y4_8c_source_1l00113"/>00113 <emphasis role="keywordtype">void</emphasis>&#32;<link linkend="__free_r_t_o_s___t_e_e_n_s_y4_8c_1a201468129b483039afc5a619e2d31097">__attribute__</link>((weak))&#32;vApplicationTickHook()&#32;{
<anchor xml:id="__free_r_t_o_s___t_e_e_n_s_y4_8c_source_1l00114"/>00114 }
<anchor xml:id="__free_r_t_o_s___t_e_e_n_s_y4_8c_source_1l00115"/>00115 <emphasis role="comment">/*-----------------------------------------------------------*/</emphasis>
<anchor xml:id="__free_r_t_o_s___t_e_e_n_s_y4_8c_source_1l00118"/><link linkend="__free_r_t_o_s___t_e_e_n_s_y4_8c_1ab042bd469054b754e2710fa560fd3ff7">00118</link> <emphasis role="keywordtype">void</emphasis>&#32;<link linkend="__free_r_t_o_s___t_e_e_n_s_y4_8c_1ab042bd469054b754e2710fa560fd3ff7">vMainConfigureTimerForRunTimeStats</link>(&#32;<emphasis role="keywordtype">void</emphasis>&#32;)&#32;{}
<anchor xml:id="__free_r_t_o_s___t_e_e_n_s_y4_8c_source_1l00122"/><link linkend="__free_r_t_o_s___t_e_e_n_s_y4_8c_1a128013062564ee200ba30d0369b9865c">00122</link> <emphasis role="keywordtype">unsigned</emphasis>&#32;<emphasis role="keywordtype">long</emphasis>&#32;<link linkend="__free_r_t_o_s___t_e_e_n_s_y4_8c_1a128013062564ee200ba30d0369b9865c">ulMainGetRunTimeCounterValue</link>()&#32;{<emphasis role="keywordflow">return</emphasis>&#32;0UL;}
</programlisting></section>
